using System;  
using System.IO;  
using System.Data;  
using System.Data.SqlClient;  
using System.Configuration;  
public partial class _Default : System.Web.UI.Page  
{  
     
    SqlConnection con;  
  
    string sqlconn;  
    protected void Page_Load(object sender, EventArgs e)  
    {  
    }
    private void connection()  
    {  
        sqlconn = ConfigurationManager.ConnectionStrings["SqlCom"].ConnectionString;  
        con = new SqlConnection(sqlconn);
    }  
        string CSVFilePath = Path.GetFullPath(SRVWINSQL001);  
      
        string ReadCSV = File.ReadAllText(SRVWINSQL001);  
         
        foreach (string csvRow in ReadCSV.Split('\n'))  
        {  
            if (!string.IsNullOrEmpty(csvRow))  
            {  
                  
                tblcsv.Rows.Add();  
                int count = 0;  
                foreach (string FileRec in csvRow.Split(','))  
                {  
                     SRVWINSQL001 .Rows[ SRVWINSQL001 .Rows.Count - 1][count] = FileRec;  
                    count++;  
                }  
            }       
        }  
         
        InsertCSVRecords(SRVWINSQL001);  
    }   
    private void InsertCSVRecords(DataTable  SRVWINSQL001 )  
    {  
  
        connection();  
          
        SqlBulkCopy objbulk = new SqlBulkCopy(con);  
          
        objbulk.DestinationTableName = "Users";  
        
        objbulk.ColumnMappings.Add("LastName", "LastName");  
        objbulk.ColumnMappings.Add("FirstName", "FirstName");  
        objbulk.ColumnMappings.Add("Email", "Email");  
        objbulk.ColumnMappings.Add("Telephone", "Telephone");  
        //inserting Datatable Records to DataBase    
        con.Open();  
        objbulk.WriteToServer(SRVWINSQL001);  
        con.Close();
    }  
}
